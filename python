import os
import pandas as pd
import psycopg2
from kaggle.api.kaggle_api_extended import KaggleApi

# Kaggle-API initialisieren
api = KaggleApi()
api.authenticate()

# Daten von Kaggle herunterladen
# Dieses Beispiel lädt den Titanic-Datensatz herunter. Sie können den Datensatz und den Dateinamen an Ihre Bedürfnisse anpassen.
api.dataset_download_file('heptapod/titanic', file_name='train.csv', path='./data')

# Daten mit Pandas lesen
df = pd.read_csv('./data/train.csv')

# Verbindung zur PostgreSQL-Datenbank herstellen
conn = psycopg2.connect(
    dbname='mydatabase',
    user='myuser',
    password='mypassword',
    host='localhost'
)

# Daten in PostgreSQL laden
df.to_sql('titanic', conn, if_exists='replace', index=False)